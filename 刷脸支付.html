<!doctype html>
<html lang="zh">
<head>
<meta charset="utf-8">
<title>刷脸支付教学模拟（摄像头版）</title>
<style>
body { font-family: Arial, sans-serif; text-align:center; background:#f5f5f5; }
.page { display:none; }
.active { display:block; }

button {
  margin:10px; padding:12px 24px; font-size:18px; border:none; border-radius:6px;
  cursor:pointer;
}
.start { background:#1677ff; color:#fff; }
.ok { background:#09bb07; color:#fff; }
.cancel { background:#f44336; color:#fff; }

#camera {
  width:300px; height:220px; margin:20px auto; border:2px solid #333; border-radius:12px;
  background:#000;
}
#camera video {
  width:100%; height:100%; border-radius:12px; object-fit:cover;
}
#successMsg { font-size:28px; color:#09bb07; margin-top:40px; }
</style>
</head>
<body>

<h1>刷脸支付模拟（摄像头版）</h1>

<!-- 页面 1: 选择刷脸支付 -->
<div id="page-start" class="page active">
  <p>请选择支付方式</p>
  <button class="start" onclick="startFacePay()">刷脸支付</button>
</div>

<!-- 页面 2: 摄像头识别 -->
<div id="page-face" class="page">
  <div id="camera">
    <video id="video" autoplay></video>
  </div>
  <p id="face-msg">请看向屏幕 👀</p>
</div>

<!-- 页面 3: 金额确认 -->
<div id="page-amount" class="page">
  <p>识别成功 ✅</p>
  <div style="font-size:22px;">支付金额：<b>10 元</b></div>
  <button class="ok" onclick="confirmPay()">确认支付</button>
  <button class="cancel" onclick="cancelPay()">取消</button>
</div>

<!-- 页面 4: 成功 -->
<div id="page-success" class="page">
  <div id="successMsg">✅ 支付成功！</div>
</div>

<script>
function switchPage(id){
  document.querySelectorAll(".page").forEach(p=>p.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}

// 启动刷脸支付
async function startFacePay(){
  switchPage("page-face");
  try {
    const stream = await navigator.mediaDevices.getUserMedia({ video:true });
    document.getElementById("video").srcObject = stream;
    document.getElementById("face-msg").innerText = "正在识别中...";
    // 模拟2秒识别
    setTimeout(()=>{
      document.getElementById("face-msg").innerText = "识别完成 ✅";
      setTimeout(()=> switchPage("page-amount"), 1000);
    },2000);
  } catch(err){
    alert("无法访问摄像头，请检查权限设置");
    switchPage("page-start");
  }
}

// 确认支付
function confirmPay(){
  switchPage("page-success");
}

// 取消支付
function cancelPay(){
  alert("支付已取消");
  switchPage("page-start");
}
</script>

</body>
</html>
