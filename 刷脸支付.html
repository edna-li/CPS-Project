<!doctype html>
<html lang="zh">
<head>
<meta charset="utf-8">
<title>åˆ·è„¸æ”¯ä»˜æ•™å­¦æ¨¡æ‹Ÿï¼ˆæ‘„åƒå¤´ç‰ˆï¼‰</title>
<style>
body { font-family: Arial, sans-serif; text-align:center; background:#f5f5f5; }
.page { display:none; }
.active { display:block; }

button {
  margin:10px; padding:12px 24px; font-size:18px; border:none; border-radius:6px;
  cursor:pointer;
}
.start { background:#1677ff; color:#fff; }
.ok { background:#09bb07; color:#fff; }
.cancel { background:#f44336; color:#fff; }

#camera {
  width:300px; height:220px; margin:20px auto; border:2px solid #333; border-radius:12px;
  background:#000;
}
#camera video {
  width:100%; height:100%; border-radius:12px; object-fit:cover;
}
#successMsg { font-size:28px; color:#09bb07; margin-top:40px; }
</style>
</head>
<body>

<h1>åˆ·è„¸æ”¯ä»˜æ¨¡æ‹Ÿï¼ˆæ‘„åƒå¤´ç‰ˆï¼‰</h1>

<!-- é¡µé¢ 1: é€‰æ‹©åˆ·è„¸æ”¯ä»˜ -->
<div id="page-start" class="page active">
  <p>è¯·é€‰æ‹©æ”¯ä»˜æ–¹å¼</p>
  <button class="start" onclick="startFacePay()">åˆ·è„¸æ”¯ä»˜</button>
</div>

<!-- é¡µé¢ 2: æ‘„åƒå¤´è¯†åˆ« -->
<div id="page-face" class="page">
  <div id="camera">
    <video id="video" autoplay></video>
  </div>
  <p id="face-msg">è¯·çœ‹å‘å±å¹• ğŸ‘€</p>
</div>

<!-- é¡µé¢ 3: é‡‘é¢ç¡®è®¤ -->
<div id="page-amount" class="page">
  <p>è¯†åˆ«æˆåŠŸ âœ…</p>
  <div style="font-size:22px;">æ”¯ä»˜é‡‘é¢ï¼š<b>10 å…ƒ</b></div>
  <button class="ok" onclick="confirmPay()">ç¡®è®¤æ”¯ä»˜</button>
  <button class="cancel" onclick="cancelPay()">å–æ¶ˆ</button>
</div>

<!-- é¡µé¢ 4: æˆåŠŸ -->
<div id="page-success" class="page">
  <div id="successMsg">âœ… æ”¯ä»˜æˆåŠŸï¼</div>
</div>

<script>
function switchPage(id){
  document.querySelectorAll(".page").forEach(p=>p.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}

// å¯åŠ¨åˆ·è„¸æ”¯ä»˜
async function startFacePay(){
  switchPage("page-face");
  try {
    const stream = await navigator.mediaDevices.getUserMedia({ video:true });
    document.getElementById("video").srcObject = stream;
    document.getElementById("face-msg").innerText = "æ­£åœ¨è¯†åˆ«ä¸­...";
    // æ¨¡æ‹Ÿ2ç§’è¯†åˆ«
    setTimeout(()=>{
      document.getElementById("face-msg").innerText = "è¯†åˆ«å®Œæˆ âœ…";
      setTimeout(()=> switchPage("page-amount"), 1000);
    },2000);
  } catch(err){
    alert("æ— æ³•è®¿é—®æ‘„åƒå¤´ï¼Œè¯·æ£€æŸ¥æƒé™è®¾ç½®");
    switchPage("page-start");
  }
}

// ç¡®è®¤æ”¯ä»˜
function confirmPay(){
  switchPage("page-success");
}

// å–æ¶ˆæ”¯ä»˜
function cancelPay(){
  alert("æ”¯ä»˜å·²å–æ¶ˆ");
  switchPage("page-start");
}
</script>

</body>
</html>
